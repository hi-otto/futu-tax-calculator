# 开发任务清单（TODO）

## Phase 1：核心功能（MVP）

### 1.1 核心模块开发
- [ ] **types.ts** - 定义所有 TypeScript 类型
  - 账单数据结构
  - 税务计算结果结构
  - 汇率数据结构
  
- [ ] **exchange.ts** - 汇率数据模块
  - 内置 2020-2025 年 12月31日 汇率数据
  - 汇率转换函数
  - 汇率来源说明
  
- [ ] **parser.ts** - 账单解析模块
  - 解析年度账单 xlsx 文件
  - 提取账户信息
  - 提取交易流水
  - 提取资金进出（股息/利息/预扣税）
  - 解析利息股息汇总文件（用于核对）
  
- [ ] **calculator.ts** - 税务计算模块
  - 资本利得计算（买卖差价）
  - 股息税计算
  - 利息税计算
  - 境外已扣税抵免计算
  - 汇率转换为人民币

### 1.2 Web 界面开发
- [ ] **布局组件** - Header, Footer, Container
- [ ] **文件上传组件** - 拖拽上传 + 文件列表
- [ ] **解析进度组件** - 进度条 + 状态提示
- [ ] **结果展示组件** - 税务计算结果卡片
- [ ] **汇率说明组件** - 汇率来源和免责声明
- [ ] **导出功能** - CSV 导出

### 1.3 页面集成
- [ ] **index.html** - HTML 入口
- [ ] **App.tsx** - 主应用组件
- [ ] **index.ts** - Bun.serve 服务入口
- [ ] **响应式适配** - 移动端优先

## Phase 2：增强功能

### 2.1 CLI 工具（Bun 开发）
- [ ] **cli.ts** - CLI 入口
- [ ] 命令行参数解析
- [ ] 文件读取和解析
- [ ] 表格格式输出
- [ ] JSON/CSV 格式输出
- [ ] 帮助信息

### 2.2 Docker 部署
- [ ] **Dockerfile** - 容器构建配置
- [ ] **docker-compose.yml** - 编排配置
- [ ] 构建和测试流程

### 2.3 测试
- [ ] 解析模块单元测试
- [ ] 计算模块单元测试
- [ ] 汇率转换测试
- [ ] 端到端测试（使用样本文件）

## Phase 3：优化迭代

### 3.1 UI/UX 优化
- [ ] 加载动画优化
- [ ] 错误提示优化
- [ ] 计算明细展开/折叠
- [ ] 暗色模式支持

### 3.2 功能增强
- [ ] PDF 报告导出
- [ ] 多语言支持
- [ ] 计算历史记录（本地存储）

### 3.3 文档完善
- [ ] README.md 完善
- [ ] 使用说明
- [ ] 贡献指南
- [ ] CHANGELOG

---

## 当前进度

**状态**：Phase 2 进行中 ✅

**已完成**：
- 核心模块（types, exchange, parser, calculator）
- Web 界面组件（FileUploader, TaxResult）
- 页面集成（App.tsx, index.html）
- CLI 工具（cli.ts）
- Docker 配置（Dockerfile, docker-compose.yml）
- 单元测试（18 个测试全部通过）
- 浏览器验证
- 滞纳金计算器（根据税法规定，按日加收万分之五）
- 预扣税等专业术语解释说明
- 详情区域 Tab 切换（资本利得/股息/汇率信息）
- 文件清空后数据重置 bug 修复

**下一步**：Phase 3 功能增强
